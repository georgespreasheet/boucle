function deleteRowsNotInSource() {
  const sourceSheetId = 'xxx';
  const sourceSheetName = 'xxx';
  const destinationSheetName = 'xxx';

  const destinationSheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName(destinationSheetName);
  if (!destinationSheet) {
    throw new Error('Feuille de calcul destination introuvable');
  }

  const sourceSheet = SpreadsheetApp.openById(sourceSheetId).getSheetByName(sourceSheetName);
  if (!sourceSheet) {
    throw new Error('Feuille de calcul source introuvable');
  }

  const sourceRange = sourceSheet.getRange('A2:A');
  const sourceValues = sourceRange.getValues().flat();

  const destinationRange = destinationSheet.getRange('A2:A');
  const destinationValues = destinationRange.getValues().flat();

  const rowsToDelete = [];

  destinationValues.forEach(function (destinationValue, index) {
    if (!sourceValues.includes(destinationValue)) {
      rowsToDelete.push(index + 2);
    }
  });

  rowsToDelete.reverse().forEach(function (rowToDelete) {
    destinationSheet.deleteRow(rowToDelete);
  });
}
